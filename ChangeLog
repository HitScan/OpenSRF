ChangeLog
=========

OpenSRF 2.2.0
-------------

commit c5563a175edf84e11e628d254b566ae5344df80b
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Fri Apr 19 20:06:40 2013 -0400

    bump up version to 2.2.0
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2	2	src/perl/lib/OpenSRF.pm
1	1	src/python/setup.py
1	1	version.m4

commit 2a0eff986aef7b45043baf67b788833060e05351
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Fri Apr 19 20:04:19 2013 -0400

    updated release notes for 2.2.0
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

4	2	doc/RELEASE_NOTES.txt

commit 161cb3fa16e518c63ac2680082bfde118312be27
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Thu Apr 4 23:01:49 2013 -0400

    LP#1162907: don't require installing RPC::XML
    
    RPC::XML is not required by OpenSRF, although it is an
    Evergreen dependency.
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>
    Signed-off-by: Mike Rylander <mrylander@gmail.com>

0	2	src/extras/Makefile.install

commit 4b2118dc1f2f5d09ae5c7b931777c21c46df6fc1
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Tue Mar 19 11:14:31 2013 -0400

    remove Fedora 16 from the supported platforms list
    
    Per commit 2c6fabe8
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

1	1	doc/RELEASE_NOTES.txt

commit 32e2cce60ac342ba7e1c2437a04080f61737efe6
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Tue Mar 19 01:23:31 2013 -0400

    add one last change to the release notes for 2.2.0-alpha
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

3	0	doc/RELEASE_NOTES.txt

commit de5f067661d9ce77fcd5260101e8c633a76b0495
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Sun Mar 17 16:37:46 2013 -0700

    release notes for 2.2.0-alpha
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

75	0	doc/RELEASE_NOTES.txt
 create mode 100644 doc/RELEASE_NOTES.txt

commit bc0c14b5c2dad7d4849eb36875f63cd7e5254ba3
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Sun Mar 17 15:16:51 2013 -0700

    bump up version numbers for 2.2.0-alpha release
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2	2	src/perl/lib/OpenSRF.pm
1	1	src/python/setup.py
1	1	version.m4

commit a9182c03a3b61953751fda2da0e881d47f95e035
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Sun Mar 17 14:50:34 2013 -0700

    ChangeLog for 2.2.0-alpha
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

185	1189	ChangeLog

commit 78f15b09801f508a8db3b03cf40ab73c6d6b144d
Author: Bill Erickson <berick@esilibrary.com>
Date:   Fri Mar 15 15:56:55 2013 -0400

    Multisession blocking repair
    
    The new socket blocking code for multisession failed to take into
    account that socket activity outside of the main block could lead to a
    deadlock situation.  For example:
    
    * Check status of request A -> not complete
    * Check status of request B -> whatever
    * Request A may now be complete, since checking the status of any request
      affects all requests
    * Return to blocking loop because we think there is pending data, but in
      fact all data has already been pulled from the socket.
    
    The solution is for session_reap() to make a sweep and check for changes
    in requests that are now complete as a side-effect of checking for
    completed requests.
    
    Signed-off-by: Bill Erickson <berick@esilibrary.com>
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

14	0	src/perl/lib/OpenSRF/MultiSession.pm

commit c8b808c739637ec68f2d8181f73d93f880f55dd6
Author: Lebbeous Fogle-Weekley <lebbeous@esilibrary.com>
Date:   Wed Nov 14 14:50:46 2012 -0500

    When running methods for clients, send plain warnings to "real" logs
    
    Code inside an OpenSRF application method may use Perl libraries that warn
    and carp like most Perl code is wont to do.  Instead of letting
    those message go to STDERR where they can be easily missed (and take up
    lots of disk space on application boxes), why not catch them and
    redirect them to our "real" logs using OpenSRF::Utils::Logger ?
    
    Deployment of this change would probably have the side effect of bringing
    to light bugs in applications (Evergreen) that will suddenly seem very
    noisy.
    
    Signed-off-by: Lebbeous Fogle-Weekley <lebbeous@esilibrary.com>
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

10	0	src/perl/lib/OpenSRF/Application.pm

commit df3155f9a3d9259ce64b27fb834450f99e85d8e2
Author: Bill Erickson <berick@esilibrary.com>
Date:   Tue Oct 16 09:28:20 2012 -0400

    Minor whitespace repairs in Server.pm
    
    Signed-off-by: Bill Erickson <berick@esilibrary.com>
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

7	7	src/perl/lib/OpenSRF/Server.pm

commit dd09c46cfd3bc445a879257bb530117b904f09fa
Author: Bill Erickson <berick@esilibrary.com>
Date:   Mon Oct 15 17:23:19 2012 -0400

    Perl SIGHUP handling and config reloading
    
    Sending the HUP signal to a Perl Listener process now results in the
    following:
    
     * Reload the opensrf_core config
     * re-init the logger
     * kill idle child processes
     * child processes that are active when the signal is received are
       tracked and killed once they become idle.
     * New children are spawned per the min child settings
    
    The primary use case for these changes is temporarily changing the log
    level (or log file) for a given service for debug purposes.  It may also
    be used, for example, to gracefully recover excess RAM consumed by a
    child process.
    
    Not all values in opensrf_core.xml are affected by a SIGHUP.  Since the
    goal is a gracful reload, no attempt is made by the listener process to
    re-connect to jabber or re-register with the opensrf router(s).  Child
    processes will by necessity connect to Jabber during startup, though, so
    any changes to the jabber configuration will affect child processes.  In
    general, it's best to affect jabber configuration changes with a true
    service restart.
    
    opensrf.xml (opensrf.settings config) is not reloaded, so min/max child
    settings will not be affected.
    
    Signed-off-by: Bill Erickson <berick@esilibrary.com>
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

52	1	src/perl/lib/OpenSRF/Server.pm
2	1	src/perl/lib/OpenSRF/Utils/Logger.pm

commit 51dfd2c93ded26db5820201a1e43ed8e3cdb7d99
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Fri Jan 18 13:12:35 2013 -0500

    LP#1101254: remove memory leak in HTTP translator
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>
    Signed-off-by: Bill Erickson <berick@esilibrary.com>

5	1	src/gateway/osrf_http_translator.c

commit 0d6feed4b9ca2f7335aabcb55383a8a0270480b1
Author: Bill Erickson <berick@esilibrary.com>
Date:   Tue Jun 19 15:36:25 2012 -0400

    Debian wheezy Makefile.install target
    
    Signed-off-by: Bill Erickson <berick@esilibrary.com>
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

1	0	README
15	1	src/extras/Makefile.install

commit 56fa5ed7e9e0aceb4504a5bb279fa626d55a5fc0
Author: Bill Erickson <berick@esilibrary.com>
Date:   Thu Jan 31 15:05:53 2013 -0500

    Block on recv instead of loop/polling in MultiSession
    
    When the time comes to wait for responses to arrive, block on the XMPP
    socket (which uses select() under the covers) until data arrives,
    instead of looping furiously and calling receive in non-blocking mode.
    Before this change, waiting on responses resulted in long-running CPU
    spikes.
    
    Signed-off-by: Bill Erickson <berick@esilibrary.com>
    Signed-off-by: Lebbeous Fogle-Weekley <lebbeous@esilibrary.com>

5	1	src/perl/lib/OpenSRF/MultiSession.pm

commit 8abac65dac48cc9bbd415741193e3fb873fdbc82
Author: Dan Scott <dscott@laurentian.ca>
Date:   Fri Oct 19 16:28:59 2012 -0400

    Stop using a non-standard default PREFIX for installs
    
    Working towards packaging, we will be better off if we start getting used to
    installing OpenSRF in standard FHS directories.
    
    Signed-off-by: Dan Scott <dscott@laurentian.ca>
    Signed-off-by: Jason Stephenson <jstephenson@mvlc.org>

0	1	configure.ac

commit c676cfc19134df88e9586954dd350be347189a0c
Author: Galen Charlton <gmc@esilibrary.com>
Date:   Sat Feb 23 00:26:06 2013 -0800

    LP#1132247: fix compilation warnings in C test cases
    
    Also, since osrfList maintains a list of pointers, not
    values, adjust some of the test cases to discourage
    anybody inclined to copy-and-paste from the test cases
    from storing pointers to stack variables in an osrfList.
    
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>
    Signed-off-by: Ben Shum <bshum@biblio.org>

53	45	tests/check_osrf_list.c
1	1	tests/check_osrf_message.c

commit 77d42eea11a3551331e6cecd409f575ae584548d
Author: Bill Erickson <berick@esilibrary.com>
Date:   Wed Oct 17 14:37:01 2012 -0400

    Logger.pm whitespace cleanup
    
    Apply 4-space "tabs" consistently.
    
    Signed-off-by: Bill Erickson <berick@esilibrary.com>
    Signed-off-by: Lebbeous Fogle-Weekley <lebbeous@esilibrary.com>

128	129	src/perl/lib/OpenSRF/Utils/Logger.pm

commit 7667d34b4913b57740695a912a69f4d520fbcb9f
Author: Bill Erickson <berick@esilibrary.com>
Date:   Wed Oct 17 14:31:02 2012 -0400

    Enable client logtrace with environment vars
    
    Supports a new environment variable OSRF_LOG_CLIENT which, if true,
    enables control and generation of the client log trace value.  This is
    the same as setting <client>true</client> within the opensrf core
    configuration file.
    
    As a shortcut, if the MOD_PERL environment variable is set, assume
    client=true.
    
    This allows clients and non-clients to share an opensrf core
    configuration file, when previously the only difference between the two
    was the <client> setting.
    
    Signed-off-by: Bill Erickson <berick@esilibrary.com>
    Signed-off-by: Lebbeous Fogle-Weekley <lebbeous@esilibrary.com>

6	0	src/perl/lib/OpenSRF/Utils/Logger.pm

commit f086d4c0aaaa605139aa18658a62fa919294cdc8
Author: Dan Scott <dscott@laurentian.ca>
Date:   Sun Jan 27 11:08:12 2013 -0500

    Test for Apache executable in sbin dirs
    
    Debian apparently doesn't include /usr/sbin in the default user PATH, so
    add an APXS2-like lookup with likely locations if we don't find the
    apache executable in our standard path.
    
    Signed-off-by: Dan Scott <dscott@laurentian.ca>
    Signed-off-by: Jason Etheridge <jason@esilibrary.com>
    Signed-off-by: Ben Shum <bshum@biblio.org>

11	2	configure.ac

commit 0c40bc6c40ff55b1ddf8bfe9b5e6ebaa87be5113
Author: Dan Scott <dscott@laurentian.ca>
Date:   Wed Jan 16 21:59:22 2013 -0500

    Support Apache 2.4 client IP address lookups
    
    The Apache 2.4 API replaces the conn_rec->remote_ip member with
    conn_rec->client_ip or conn_rec->useragent_ip (per
    http://httpd.apache.org/docs/2.4/developer/new_api_2_4.html). client_ip
    seems to be the best choice for us, to avoid everything being logged
    from the load balancer or proxy instead of the client's address.
    
    This code detects the version of Apache and uses client_ip if it is 2.4
    or greater.
    
    Signed-off-by: Dan Scott <dscott@laurentian.ca>
    Signed-off-by: Bill Erickson <berick@esilibrary.com>

24	0	configure.ac
5	2	src/gateway/Makefile.am
4	0	src/gateway/osrf_http_translator.c
5	0	src/gateway/osrf_json_gateway.c

commit d390d1ae315bd9c9326c9ef76ebf74f57ddaa573
Author: Bill Erickson <berick@esilibrary.com>
Date:   Tue Jun 26 09:21:57 2012 -0400

    Prevent "uninitialized value" warnings in parameter logging
    
    Use of uninitialized value $p[0] in join or string at
    /usr/local/share/perl/5.10.1/OpenSRF/Application.pm line 130.
    
    This is caused when the array of method params contains null/undef
    values.  Prevent the warnings by replacing these values w/ empty
    strings.
    
    Signed-off-by: Bill Erickson <berick@esilibrary.com>
    Signed-off-by: Dan Scott <dscott@laurentian.ca>
    Signed-off-by: Galen Charlton <gmc@esilibrary.com>

1	1	src/perl/lib/OpenSRF/Application.pm

commit c0630d2bcedb086ac4e8bef98cc37748fc0cce3a
Author: Jason Stephenson <jstephenson@mvlc.org>
Date:   Wed Oct 31 10:21:18 2012 -0400

    Change OSRF_JAVA_DEPSDIR so building Java just works.
    
    OSRF_JAVA_DEPSDIR was being set to /opt/java by configure without any
    documentation to that effect. The src/java/deps.sh downloads the deps files
    to src/java/deps. This means that you cannot just build java without either
    copying the jars from src/java/deps or altering src/java/Makefile.
    
    This edit changes the AC_SUBST call to replace OSRF_JAVA_DEPSDIR with deps,
    so that you can at least build java without making any changes.
    
    Signed-off-by: Jason Stephenson <jstephenson@mvlc.org>
    Signed-off-by: Bill Erickson <berick@esilibrary.com>

1	1	configure.ac

commit d262e2892203dc74fcd1abc69a9ae7458566b18a
Author: Bill Erickson <berick@esilibrary.com>
Date:   Thu Nov 1 09:41:52 2012 -0400

    Safer casting in java config parsing
    
    Java config parsing, in particular getString and getInt, no longer fail
    when encountering a number value in the internl JSON->Map object.
    
    Java does not allow the following cast:
    
    String s = (String) someNumber;
    
    Instead, rely on the object's toString() which is safe and guaranteed
    to exist.
    
    Signed-off-by: Bill Erickson <berick@esilibrary.com>
    Signed-off-by: Jason Stephenson <jstephenson@mvlc.org>
    Signed-off-by: Dan Scott <dscott@laurentian.ca>

1	1	src/java/org/opensrf/util/Config.java

commit 2883586dd2c6852ce817dcf117d263283e14c9e1
Author: Dan Scott <dscott@laurentian.ca>
Date:   Mon Nov 19 10:51:26 2012 -0500

    Typo in configure.ac: 'framweork'
    
    Reported by David Busby of edoceo in
    https://bugs.launchpad.net/opensrf/+bug/1080458 - thanks David!
    
    Signed-off-by: Dan Scott <dscott@laurentian.ca>

1	1	configure.ac
